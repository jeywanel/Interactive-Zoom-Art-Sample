<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Infinite Zoom Art – Mobile</title>

<style>
    body {
        margin: 0;
        background: black;
        overflow: hidden;
        font-family: sans-serif;
        user-select: none;
        touch-action: none;
    }

    /* FULLSCREEN */
    #screen {
        width: 100vw;
        height: 100vh;
        position: relative;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    /* ZOOM AREA */
    .zoom-box {
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        position: relative;
        touch-action: none;
    }

    .zoom-img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        transform-origin: center center;
        touch-action: none;
    }

    /* START BUTTON */
    #startBtn {
        position: absolute;
        bottom: 40px;
        padding: 15px 30px;
        background: #FFD86B;
        border-radius: 30px;
        color: black;
        font-size: 22px;
        border: none;
        box-shadow: 0 0 15px #ffd86b;
    }

    /* POPUP */
    #popup {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 15px 20px;
        border-radius: 10px;
        display: none;
        max-width: 80%;
        text-align: center;
        z-index: 1000;
    }

    /* --- LAYER MENU BUTTON --- */
    #layerBtn {
        position: fixed;
        top: 10px;
        right: 10px;
        width: 50px;
        height: 50px;
        background: #FFD86B;
        border-radius: 50%;
        display: none;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        border: none;
        box-shadow: 0 0 10px #ffd86b;
        z-index: 1100;
    }

    /* --- DROPDOWN MENU --- */
    #layerMenu {
        position: fixed;
        top: 70px;
        right: 10px;
        background: rgba(0,0,0,0.75);
        backdrop-filter: blur(4px);
        padding: 10px;
        border-radius: 10px;
        display: none;
        flex-direction: column;
        z-index: 1099;
        animation: fadeIn 0.25s ease-out;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    #layerMenu button {
        margin-bottom: 5px;
        padding: 8px 12px;
        border: none;
        background: #222;
        color: white;
        border-radius: 5px;
        text-align: left;
    }
</style>
</head>
<body>

<div id="popup"></div>

<!-- NEW MENU BUTTON -->
<button id="layerBtn">≡</button>

<!-- NEW HIDDEN DROPDOWN MENU -->
<div id="layerMenu">
    <button onclick="goLayer('Interface1')">Main Menu</button>
    <button onclick="goLayer('zoom1')">Community</button>
    <button onclick="goLayer('zoom2')">Topsoil</button>
    <button onclick="goLayer('zoom3')">Subsoil</button>
    <button onclick="goLayer('zoom4')">Parent Material</button>
    <button onclick="goLayer('zoom5')">Bedrock</button>
</div>

<div id="screen"></div>

<script>
let screenEl = document.getElementById("screen");
let popup = document.getElementById("popup");
let layerBtn = document.getElementById("layerBtn");
let layerMenu = document.getElementById("layerMenu");

layerBtn.onclick = () => {
    layerMenu.style.display = (layerMenu.style.display === "flex") ? "none" : "flex";
};

function showPopup(text) {
    popup.style.display = "block";
    popup.innerText = text;
    setTimeout(() => popup.style.display = "none", 3000);
}

function goLayer(layer) {
    layerMenu.style.display = "none";
    loadScene(layer);
}

function loadScene(layer) {
    screenEl.innerHTML = "";

    // Menu button only appears on zoom layers
    layerBtn.style.display = (layer === "Interface1") ? "none" : "flex";

    if (layer === "Interface1") {
        let img = document.createElement("img");
        img.src = "Interface1.png";
        img.style.width = "100vw";
        img.style.height = "100vh";
        img.style.objectFit = "cover";

        let btn = document.createElement("button");
        btn.id = "startBtn";
        btn.innerText = "Start the Journey";
        btn.onclick = () => loadScene("zoom1");

        screenEl.appendChild(img);
        screenEl.appendChild(btn);
        return;
    }

    // ZOOM BOX
    let box = document.createElement("div");
    box.className = "zoom-box";

    let img = document.createElement("img");
    img.src = layer + ".png";
    img.className = "zoom-img";

    box.appendChild(img);
    screenEl.appendChild(box);

    // POPUPS
    let messages = {
        zoom1: "Welcome to the Community!             Everything looks normal… except for that suspicious crack on the ground!",
        zoom2: "Welcome to the Topsoil!                     The soft, rich layer where plants grow and roots party underground!",
        zoom3: "You’ve reached the Subsoil!                 Denser, tougher, and packed with clay—where roots struggle but still sneak in.",
        zoom4:"Now entering Parent Material!              Chunky rocks and rough textures—this is the Earth’s construction zone.",
        zoom5:"Welcome to the Bedrock!                      The deepest, hardest layer—solid rock holding the whole ground together."
    };
    if (messages[layer]) showPopup(messages[layer]);

    // PINCH ZOOM
    let scale = 1;
    let lastDist = 0;

    box.addEventListener("touchmove", e => e.preventDefault());

    box.addEventListener("touchstart", e => {
        if (e.touches.length === 2) {
            let dx = e.touches[0].clientX - e.touches[1].clientX;
            let dy = e.touches[0].clientY - e.touches[1].clientY;
            lastDist = Math.sqrt(dx*dx + dy*dy);
        }
    });

    box.addEventListener("touchmove", e => {
        if (e.touches.length === 2) {
            let dx = e.touches[0].clientX - e.touches[1].clientX;
            let dy = e.touches[0].clientY - e.touches[1].clientY;
            let newDist = Math.sqrt(dx*dx + dy*dy);

            let delta = newDist - lastDist;
            scale += delta * 0.005;
            scale = Math.min(Math.max(scale, 1), 4);

            img.style.transform = `scale(${scale})`;

            lastDist = newDist;

            checkCrack(layer, scale);
        }
    });

    function checkCrack(layer, scale) {
        if (scale < 2) return;

        if (layer === "zoom1") loadScene("zoom2");
        if (layer === "zoom2") loadScene("zoom3");
        if (layer === "zoom3") loadScene("zoom4");
        if (layer === "zoom4") loadScene("zoom5");
    }
}

loadScene("Interface1");
</script>

</body>
</html>